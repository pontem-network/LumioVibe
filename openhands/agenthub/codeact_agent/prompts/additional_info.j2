{% if runtime_info -%}
<RUNTIME_INFORMATION>
{% if runtime_info.working_dir %}
Working directory: {{ runtime_info.working_dir }}
{% endif %}
{% if runtime_info.available_hosts %}
Available hosts for web apps:
{% for host, port in runtime_info.available_hosts.items() -%}
* {{ host }} (port {{ port }})
{% endfor %}
Use these ports for dev servers. Set server.host=true for Vite.
{% endif %}

<LUMIO_VIBE_RUNTIME>
⚠️ LUMIO/MOVE PROJECT SETUP ⚠️

**Start with:** `bash /openhands/templates/scaffold-fast.sh PROJECT_NAME`

This creates everything: account, funding, contract template, frontend template.

❌ NEVER: `lumio init` manually, create Move.toml manually
✅ Config location: /workspace/.lumio/config.yaml

---

**Pre-installed (DO NOT install):**
* lumio CLI v7.8.0: /openhands/bin/lumio
* Node.js v22+, pnpm, TypeScript, Vite

**Lumio Network (CRITICAL):**
* Chain ID: **2** (NOT 1 or 4!)
* RPC: **https://api.testnet.lumio.io/v1**
* Native Coin: `0x1::lumio_coin::LumioCoin` (NOT AptosCoin!)

---

⛔ **NO MOCK DATA IN FRONTEND** ⛔

ALL data MUST come from blockchain!

❌ FORBIDDEN:
```typescript
setBalance(1000000000);  // hardcoded
// Mock data for now...
console.log(`Action`);   // no contract call
```

✅ CORRECT:
```typescript
const balance = await callView('get_balance', [account]);
setBalance(balance);

const result = await callEntry('stake', [amount]);
if (result) await refreshData();
```

**THREE FILES MUST BE CUSTOMIZED (not template defaults!):**
- `useContract.ts` - MODULE_NAME + ALL functions
- `Documentation.tsx` - YOUR contract functions (not counter!)
- `Home.tsx` - YOUR contract UI

**If data doesn't change after TX = MOCK DATA = FIX IT!**

---

⛔ **DECIMALS: CONVERT ONCE ONLY!** ⛔

```typescript
// ❌ WRONG - double conversion:
const stake = (a) => callEntry('stake', [(a*1e8).toString()]); // hook converts
await stake(parseFloat(input) * 1e8);  // handler ALSO converts!

// ✅ CORRECT - convert in ONE place only!
```

---

⛔ **AGGRESSIVE TESTING PROTOCOL** ⛔

**Philosophy: ASSUME THERE ARE BUGS - FIND THEM!**

1. **Console Clean** - NO red errors before testing!
2. **Mock Detection** - data MUST change after TX
3. **Edge Cases** - test zeros, max values, invalid inputs
4. **Error Paths** - invalid ops must be REJECTED gracefully
5. **State Consistency** - balances must add up!

**Testing Checklist:**
- [ ] Zero/empty inputs → validation error
- [ ] Over-balance amounts → "insufficient" error
- [ ] Invalid input (letters in numbers) → rejected
- [ ] Double-click → no double-submit
- [ ] Data changes after TX (not mocked!)
- [ ] Console stays clean during all tests

⛔ **AFTER ANY FIX/CHANGE:**
1. Run FULL regression (ALL tests, not just the fix!)
2. Verify fix works + nothing else broke
3. **THEN** start Production Mode on $APP_PORT_1
4. Never complete with only Test Mode running!

---

⛔ **CONTRACT CHANGES & ABI INCOMPATIBILITY** ⛔

When modifying contract code and redeploying:

**If publish fails with "BACKWARD_INCOMPATIBLE_MODULE_UPDATE":**
```
Error: BACKWARD_INCOMPATIBLE_MODULE_UPDATE - cannot upgrade module
```

This means ABI changed incompatibly. You MUST create new account:

```bash
bash /openhands/templates/redeploy-contract.sh PROJECT_DIR
```

This script will:
1. Create new Lumio account
2. Fund it from faucet
3. Update Move.toml with new address
4. Update frontend (useContract.ts, types/index.ts)
5. Compile and deploy contract

**After redeploy:**
1. Restart frontend servers (kill old, start new)
2. Initialize contract if needed
3. Run FULL regression test
4. Start Production Mode

---

**Before finish():**
- [ ] useContract.ts MODULE_NAME matches contract (NOT 'counter'!)
- [ ] Documentation.tsx describes YOUR functions (NOT counter template!)
- [ ] Decimals converted in ONE place only (no double conversion!)
- [ ] Full regression test passed in Test Mode
- [ ] **⛔ Production Mode MUST BE running on $APP_PORT_1** ← USER'S APP!
- [ ] **⛔ Contract initialized for Production** (if has initialize())
- [ ] No console errors

**⛔ CRITICAL: Without $APP_PORT_1 = NO APP FOR USER = NOT COMPLETE!**

**Vite HMR:** Don't restart server, just edit files!
</LUMIO_VIBE_RUNTIME>
{% if runtime_info.date %}
Date: {{ runtime_info.date }} (UTC)
{% endif %}
</RUNTIME_INFORMATION>
{% endif %}
