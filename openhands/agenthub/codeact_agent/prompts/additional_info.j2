{% if runtime_info -%}
<RUNTIME_INFORMATION>
{% if runtime_info.working_dir %}
Working directory: {{ runtime_info.working_dir }}
{% endif %}
{% if runtime_info.available_hosts %}
Available hosts for web apps (use these URLs to access your apps!):
{% for host, port in runtime_info.available_hosts.items() -%}
* {{ host }} (binds to port {{ port }})
{% endfor %}
Use $APP_PORT_1 for dev server binding. Use $APP_BASE_URL_1 when showing URL to user!
{% endif %}

<LUMIO_VIBE_RUNTIME>
⚠️ LUMIO/MOVE PROJECT - AUTO-DEPLOYED! ⚠️

## PROJECT IS READY!

The counter template auto-deploys to `/workspace/app` when conversation starts:
- Contract already compiled and deployed
- Frontend already running at $APP_BASE_URL_1
- `.env` file created with VITE_CONTRACT_ADDRESS

**Check status:**
```bash
ls /workspace/app
cat /workspace/app/frontend/.env
```

---

## DESIGN: Create STUNNING dApps!

Build visually impressive, professional Web3 UIs:

**Pre-built CSS classes (use them!):**
- `.glass-card` - Glassmorphism containers
- `.btn-primary` - Gradient buttons with hover effects
- `.stat-value` - Large glowing numbers
- `.status-badge.success/warning/info` - Status indicators
- `.animate-float`, `.animate-glow` - Animations
- `.info-row/.info-label/.info-value` - Key-value displays

**Make each dApp unique!** Vary colors, layouts, icons, animations.

---

## WORKFLOW

### Phase 1: Fill spec.md (BEFORE any code!)
Create `/workspace/app/spec.md` with:
- Data Model (structs)
- Entry Functions (table)
- View Functions (table)
- User Flows

⛔ NO CODE UNTIL SPEC IS COMPLETE!

### Phase 2: Implement Contract
```bash
cd /workspace/app/contract
# Edit sources/counter.move
lumio move compile --package-dir .
```

### Phase 3: Contract Tests (MANDATORY!)
```bash
cd /workspace/app/contract
lumio move test --package-dir .
```
⛔ NO DEPLOY UNTIL ALL TESTS PASS!

### Phase 4: Redeploy Contract
```bash
# Same account (compatible changes)
bash /openhands/templates/counter/redeploy.sh /workspace/app

# New account (incompatible ABI changes)
bash /openhands/templates/counter/redeploy.sh /workspace/app --new-account
```
Script auto-updates `.env` and restarts frontend!

### Phase 5: Customize Frontend (BUILD-CHECK-RESTART!)
```bash
# 1. Make changes to frontend files
# 2. Build to verify no errors:
cd /workspace/app/frontend && pnpm build
# 3a. If FAILS → fix errors, repeat step 2
# 3b. If SUCCEEDS → restart:
bash /openhands/templates/counter/start.sh /workspace/app --background
```
⛔ NEVER skip the build step!

### Phase 6: Browser Testing
- Test ALL User Flows from spec.md
- Verify data updates after TX

---

## KEY SCRIPTS

```bash
# Redeploy contract
bash /openhands/templates/counter/redeploy.sh /workspace/app

# Redeploy with new account (for ABI changes)
bash /openhands/templates/counter/redeploy.sh /workspace/app --new-account

# Restart frontend
bash /openhands/templates/counter/start.sh /workspace/app --background

# Start in test mode
bash /openhands/templates/counter/start.sh /workspace/app --test --background
```

---

## KEY FILES

| File | Purpose |
|------|---------|
| `/workspace/app/contract/sources/counter.move` | Main contract |
| `/workspace/app/frontend/.env` | VITE_CONTRACT_ADDRESS, VITE_PRIVATE_KEY |
| `/workspace/app/frontend/src/hooks/useContract.ts` | Contract functions |
| `/workspace/app/frontend/src/pages/Home.tsx` | Main UI |

---

**Pre-installed (DO NOT install):**
* lumio CLI v7.8.0: /openhands/bin/lumio
* Node.js v22+, pnpm, TypeScript, Vite

**Lumio Network (CRITICAL):**
* Chain ID: **2** (NOT 1 or 4!)
* RPC: **https://api.testnet.lumio.io/v1**
* Native Coin: `0x1::lumio_coin::LumioCoin` (NOT AptosCoin!)

---

⛔ **NO MOCK DATA IN FRONTEND** ⛔

ALL data MUST come from blockchain!

❌ FORBIDDEN:
```typescript
setBalance(1000000000);  // hardcoded
```

✅ CORRECT:
```typescript
const balance = await callView('get_balance', [account]);
setBalance(balance);

const result = await callEntry('stake', [amount]);
if (result) await refreshData();
```

**If data doesn't change after TX = MOCK DATA = FIX IT!**

---

⛔ **URL Usage - TWO DIFFERENT CONTEXTS:** ⛔

1. **To show URL to USER:** use `$APP_BASE_URL_1`
2. **For browser() tool:** use `http://localhost:$APP_PORT_1`

❌ NEVER for browser(): `goto("$APP_BASE_URL_1")`
✅ ALWAYS for browser(): `goto("http://localhost:$APP_PORT_1")`

---

⛔ **ABI INCOMPATIBILITY** ⛔

If publish fails with "BACKWARD_INCOMPATIBLE_MODULE_UPDATE":
```bash
bash /openhands/templates/counter/redeploy.sh /workspace/app --new-account
```

---

**Before finish() CHECKLIST:**

- [ ] spec.md filled
- [ ] Contract tests pass (lumio move test)
- [ ] MODULE_NAME matches contract
- [ ] No mock data
- [ ] ALL User Flows tested
- [ ] Data refresh verified
- [ ] Frontend running

**Vite HMR:** Don't restart server, just edit files!
</LUMIO_VIBE_RUNTIME>
{% if runtime_info.date %}
Date: {{ runtime_info.date }} (UTC)
{% endif %}
</RUNTIME_INFORMATION>
{% endif %}
