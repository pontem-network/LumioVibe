import { describe, it, expect, beforeAll } from 'vitest';
import { Account } from '@aptos-labs/ts-sdk';
import { {{CLIENT_CLASS_NAME}} } from '../src';

describe('{{PROJECT_NAME}} Contract', () => {
  let client: {{CLIENT_CLASS_NAME}};
  let testAccount: Account;

  beforeAll(async () => {
    testAccount = Account.generate();

    client = new {{CLIENT_CLASS_NAME}}({
      contractAddress: '{{CONTRACT_ADDRESS}}',
      privateKey: testAccount.privateKey.toString(),
    });

    await client.fundAccount(testAccount.accountAddress.toString());
  });

  it('should check if account is not initialized', async () => {
    const isInit = await client.isInitialized(testAccount.accountAddress.toString());
    expect(isInit).toBe(false);
  });

  it('should initialize the contract', async () => {
    const tx = await client.initialize();
    expect(tx.success).toBe(true);
  });

  it('should check if account is initialized after init', async () => {
    const isInit = await client.isInitialized(testAccount.accountAddress.toString());
    expect(isInit).toBe(true);
  });

  it('should get owner address', async () => {
    const owner = await client.getOwner(testAccount.accountAddress.toString());
    expect(owner).toBe(testAccount.accountAddress.toString());
  });

  it('should get created_at timestamp', async () => {
    const createdAt = await client.getCreatedAt(testAccount.accountAddress.toString());
    expect(createdAt).toBeGreaterThan(0);
  });
});
